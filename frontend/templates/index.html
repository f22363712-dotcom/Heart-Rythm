{% extends 'base.html' %}

{% block title %}é¦–é¡µ{% endblock %}

{% block content %}
    <h2>æ¬¢è¿ä½¿ç”¨å¿ƒåŠ¨ç§¯åˆ†é¡¹ç›®</h2>
    <p>è¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºæƒ…ä¾£è®¾è®¡çš„ç§¯åˆ†ç®¡ç†ç³»ç»Ÿï¼Œå¸®åŠ©æƒ…ä¾£è®°å½•å’Œç®¡ç†å½¼æ­¤çš„ç§¯åˆ†ï¼Œä¿ƒè¿›æ„Ÿæƒ…å‘å±•ã€‚</p>
    
    <div class="stats-grid">
        <div class="stat-card">
            <h3>ğŸ§‘â€ğŸ¤â€ğŸ§‘ æƒ…ä¾£æ•°é‡</h3>
            <div class="value">{{ stats.total_couples if stats else '0' }}</div>
        </div>
        <div class="stat-card">
            <h3>ğŸ å¥–åŠ±æ•°é‡</h3>
            <div class="value">{{ stats.total_rewards if stats else '0' }}</div>
        </div>
        <div class="stat-card">
            <h3>â­ æ€»ç§¯åˆ†</h3>
            <div class="value">{{ stats.total_points if stats else '0' }}</div>
        </div>
        <div class="stat-card">
            <h3>ğŸ”„ å…‘æ¢æ¬¡æ•°</h3>
            <div class="value">{{ stats.total_exchanges if stats else '0' }}</div>
        </div>
    </div>
    
    <div class="card">
        <h3>åŠŸèƒ½ä»‹ç»</h3>
        <div style="margin-top: 20px;">
            <div style="margin-bottom: 15px;">
                <h4>ğŸ§‘â€ğŸ¤â€ğŸ§‘ æƒ…ä¾£ç®¡ç†</h4>
                <p>æ·»åŠ å’Œç®¡ç†æƒ…ä¾£ä¿¡æ¯ï¼ŒæŸ¥çœ‹ç§¯åˆ†å˜åŠ¨å†å²ã€‚</p>
            </div>
            <div style="margin-bottom: 15px;">
                <h4>ğŸ å¥–åŠ±ç®¡ç†</h4>
                <p>åˆ›å»ºå’Œç®¡ç†å¥–åŠ±å•†å“ï¼Œè®¾ç½®å…‘æ¢æ‰€éœ€ç§¯åˆ†å’Œåº“å­˜ã€‚</p>
            </div>
            <div style="margin-bottom: 15px;">
                <h4>â­ ç§¯åˆ†å˜åŠ¨</h4>
                <p>è®°å½•æƒ…ä¾£ä¹‹é—´çš„ç§¯åˆ†å˜åŠ¨ï¼Œæ·»åŠ å˜åŠ¨åŸå› ã€‚</p>
            </div>
            <div>
                <h4>ğŸ“Š ç³»ç»Ÿç»Ÿè®¡</h4>
                <p>æŸ¥çœ‹ç³»ç»Ÿçš„æ•´ä½“ç»Ÿè®¡ä¿¡æ¯ï¼Œäº†è§£ä½¿ç”¨æƒ…å†µã€‚</p>
            </div>
        </div>
    </div>
    
    <div class="card">
        <h3>å¿«é€Ÿæ“ä½œ</h3>
        <div style="display: flex; gap: 20px; margin-top: 20px;">
            <a href="/couples" class="btn">æƒ…ä¾£ç®¡ç†</a>
            <a href="/rewards" class="btn">å¥–åŠ±ç®¡ç†</a>
            <a href="/points" class="btn">ç§¯åˆ†å˜åŠ¨</a>
            <a href="/stats" class="btn">ç³»ç»Ÿç»Ÿè®¡</a>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        // é¡µé¢åŠ è½½æ—¶è·å–ç³»ç»Ÿç»Ÿè®¡æ•°æ®
        fetch('/api/stats/')
            .then(response => response.json())
            .then(data => {
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                document.querySelectorAll('.stat-card .value').forEach((card, index) => {
                    const keys = ['total_couples', 'total_rewards', 'total_points', 'total_exchanges'];
                    if (data[keys[index]] !== undefined) {
                        card.textContent = data[keys[index]];
                    }
                });
            })
            .catch(error => {
                console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
            });
    </script>
{% endblock %}
